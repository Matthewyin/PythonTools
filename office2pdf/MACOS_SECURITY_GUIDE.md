# macOS安全设置指南

## 🔐 解决"PDF转换工具"意外退出的安全提示

当您首次运行构建的Mac应用时，可能会遇到macOS的安全提示。这是正常现象，因为应用没有经过Apple的官方代码签名。

## 🚨 常见安全提示

### 提示1: "PDF转换工具"意外退出
```
"PDF转换工具"意外退出。
点按"报告"以查看更详细的信息并将报告发送给Apple。
```

### 提示2: 身份不明的开发者
```
无法打开"PDF转换工具"，因为它来自身份不明的开发者。
```

## ✅ 解决方案

### 方法1: 系统偏好设置（推荐）

1. **关闭错误对话框**
   - 点击"取消"或"忽略"

2. **打开系统偏好设置**
   - 点击Apple菜单 → 系统偏好设置
   - 选择"安全性与隐私"

3. **允许应用运行**
   - 在"通用"标签页中，您会看到：
     ```
     "PDF转换工具"已被阻止使用，因为它来自身份不明的开发者
     ```
   - 点击"仍要打开"按钮
   - 输入管理员密码（如果需要）

4. **确认运行**
   - 再次双击应用图标
   - 在新的对话框中点击"打开"

### 方法2: 终端命令

```bash
# 移除隔离属性
sudo xattr -rd com.apple.quarantine "dist/PDF转换工具.app"

# 重新启动应用
open "dist/PDF转换工具.app"
```

### 方法3: 右键菜单

1. **右键点击应用图标**
2. **选择"打开"**
3. **在对话框中点击"打开"**

## 🔧 预防措施

### 自动代码签名

我们的构建脚本现在包含自动代码签名功能：

```bash
# 重新构建应用（包含代码签名）
python office2pdf/setup_app.py clean
python office2pdf/setup_app.py py2app
```

构建过程会自动执行：
- ✅ Ad-hoc代码签名
- ✅ 减少安全提示
- ✅ 提高系统信任度

### 验证签名状态

```bash
# 检查应用签名状态
codesign -dv "dist/PDF转换工具.app"

# 验证签名有效性
codesign --verify "dist/PDF转换工具.app"
```

## 📋 分步操作指南

### 首次运行应用

1. **双击应用图标**
   ```
   PDF转换工具.app
   ```

2. **如果出现安全提示**：
   - 不要点击"移到废纸篓"
   - 点击"取消"

3. **打开系统偏好设置**：
   - 🍎 Apple菜单 → 系统偏好设置
   - 🔒 安全性与隐私

4. **允许应用**：
   - 在"通用"标签页找到应用提示
   - 点击"仍要打开"
   - 输入密码确认

5. **重新启动应用**：
   - 双击应用图标
   - 在新对话框中点击"打开"

### 后续运行

完成首次设置后，应用将正常启动，不再出现安全提示。

## 🛡️ 安全说明

### 为什么会出现安全提示？

1. **未经Apple公证**：应用没有通过Apple的公证程序
2. **本地构建**：应用是在本地机器上构建的
3. **开发者身份**：没有使用Apple开发者证书签名

### 应用是否安全？

- ✅ **源码透明**：所有代码都是开源的
- ✅ **本地构建**：应用在您的机器上构建
- ✅ **无网络通信**：应用不会发送数据到外部服务器
- ✅ **文件处理**：只处理您选择的本地文件

### 提高安全性

如果您需要更高的安全性，可以：

1. **申请Apple开发者账号**
2. **使用开发者证书签名**
3. **通过Apple公证程序**

## 🔍 故障排除

### 应用仍然无法启动

1. **检查macOS版本**：
   - 需要macOS 10.12或更高版本

2. **重新构建应用**：
   ```bash
   python office2pdf/setup_app.py clean
   python office2pdf/setup_app.py py2app
   ```

3. **检查权限**：
   ```bash
   ls -la "dist/PDF转换工具.app"
   ```

4. **查看系统日志**：
   - 打开"控制台"应用
   - 查看相关错误信息

### 获取更多帮助

- **详细文档**：[README.md](README.md)
- **构建指南**：[BUILD_INSTRUCTIONS.md](BUILD_INSTRUCTIONS.md)
- **快速开始**：[../QUICK_START.md](../QUICK_START.md)

## 📞 联系支持

如果问题仍然存在，请：

1. 查看应用日志
2. 记录错误信息
3. 联系开发者：Matthew Yin (2738550@qq.com)

---

*最后更新: 2025-07-30*
